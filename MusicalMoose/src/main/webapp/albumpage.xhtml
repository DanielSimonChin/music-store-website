<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <head>

        <title>Musical Moose</title>

    </head>

    <h:body>
        <ui:composition template="/templates/common.xhtml">
            <ui:define name="content">
                <link rel="stylesheet" href="trackpage.css"/>

                <div class="wrapper">
                    <section class="main-container">

                        <div class="location" id="home">

                            <!-- A global variable representing the Album object being shown on this page -->
                            <ui:param name="detailAlbum" value="#{albumJpaController.getSelectedAlbum()}" />

                            <h1 id="track">#{detailAlbum.albumtitle}</h1>

                            <div class="box">
                                <img id="mainTrack" src="album_covers/#{detailAlbum.albumimagefilenamebig}" alt="" />
                                <table id="sameAlbum">
                                    <tr>
                                        <th>Album tracks</th>
                                    </tr>

                                    <!-- Find all the tracks that are part of this track's album -->
                                    <ui:repeat value="#{albumJpaController.getAlbumTracks(detailAlbum.albumid)}" var="albumTracks">
                                        <tr>
                                            <th>
                                                <h:form>
                                                    <!-- Create a link that brings the user to the track page of the related track from the same album-->
                                                    <h:commandLink value="#{albumTracks.tracktitle}" action="#{musicTrackJpaController.showTrackFromAlbum(albumTracks)}">
                                                    </h:commandLink>
                                                </h:form>
                                            </th>
                                        </tr>
                                    </ui:repeat>

                                    <div id="shopCart">
                                        <button>
                                            <img src="icons/shopping-cart.png"/>
                                            <p>Add to cart</p>  
                                        </button>
                                    </div>
                                </table>

                                <table id="albumInfo">
                                    <tr>
                                        <th>Album Info</th>
                                    </tr>
                                    <tr>
                                        <td><u>Album title:</u> #{detailAlbum.albumtitle}</td>
                                    </tr>
                                    <tr>
                                        <td><u>Artist:</u> #{detailAlbum.artist}</td>
                                    </tr>
                                    <tr>
                                        <td><u>Release Date:</u> #{detailAlbum.releasedate}</td>
                                    </tr>
                                </table>

                                <table id="albumInfoExtra">
                                    <tr>
                                    </tr>
                                    <tr>
                                    </tr>
                                    <tr>
                                        <td><u>Recording label:</u> #{detailAlbum.recordlabel}</td>
                                    </tr>
                                    <tr>
                                        <td><u>Price:</u> $#{detailAlbum.listprice}</td>
                                    </tr>
                                    <tr>
                                        <td><u>Date entered into inventory:</u> #{detailAlbum.dateentered}</td>
                                    </tr>
                                    <tr>
                                        <td><u>Number of tracks:</u> #{detailAlbum.numberoftracks} </td>
                                    </tr>
                                </table>

                                <br></br>

                                <div id="relAlb">
                                    <h1 id="myList">Related Albums</h1>

                                    <div id="relatedAlbums" class="relBox">

                                        <!-- Show 3 other albums from the same genre -->
                                        <ui:repeat value="#{albumJpaController.findRelatedAlbums(detailAlbum)}" var="relatedAlbums">
                                            <h:form id="form">
                                                <!-- Link each album to its album page -->
                                                <h:commandLink value="#{relatedAlbums.albumtitle}" action="#{albumJpaController.showRelatedAlbum(relatedAlbums)}">
                                                    <h:graphicImage value="album_covers/#{relatedAlbums.albumimagefilenamebig}" />
                                                </h:commandLink>
                                            </h:form>
                                        </ui:repeat>
                                    </div> 
                                </div>


                            </div>


                        </div>

                        <div class="ratings">
                            <h1>Reviews</h1>

                            <!-- Display all the reviews for an album's tracks -->
                            <ui:repeat value="#{reviewJpaController.getAlbumTrackReviews(detailAlbum)}" var="albumTrackReviews">
                                <div class="rating">
                                    <hr/>

                                    <ui:param name="track" value="#{musicTrackJpaController.findMusicTrack(albumTrackReviews.inventoryid.inventoryid)}" />
                                    <h4>#{track.tracktitle}</h4>

                                    <h4>"#{albumTrackReviews.reviewtext}"</h4>

                                    <h3>#{albumTrackReviews.rating}/10 rating</h3>
                                    <small>from <u>#{albumTrackReviews.clientname}</u></small><br></br>
                                    <small>Written on: #{albumTrackReviews.reviewdate}</small>
                                </div>
                            </ui:repeat>
                        </div>
                    </section>
                </div>
            </ui:define>
        </ui:composition>
    </h:body>

</html>